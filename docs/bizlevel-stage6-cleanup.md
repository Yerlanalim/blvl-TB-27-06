# BizLevel Этап 6: Финальная очистка и оптимизация

## Обзор этапа
Этап 6 фокусируется на полном удалении остатков программистского функционала, русификации интерфейса, упрощении UX для MVP и финальной оптимизации. После его завершения BizLevel будет полностью готов к запуску как платформа бизнес-образования.

**Критически важно:** Все удаления делаем поэтапно с проверкой работоспособности после каждого шага.

---

## ЭТАП 6.1: Очистка базы данных и миграции (2 дня)

### Задача 6.1.1: Создание бэкапа базы данных
**Промпт для Cursor:**
```
Создай скрипт scripts/backup-database.sh для полного бэкапа Supabase:

1. Экспортируй структуру всех таблиц
2. Сохрани данные в формате SQL
3. Создай архив backup-$(date +%Y%m%d-%H%M%S).tar.gz
4. Добавь инструкции по восстановлению в README

ВАЖНО: Убедись что сохраняются ВСЕ данные пользователей и подписок.
```

**Проверка после выполнения:**
- [ ] Бэкап создан и сохранен локально
- [ ] Проверена возможность восстановления на тестовой БД
- [ ] Документация по восстановлению добавлена

### Задача 6.1.2: Миграция поля codeSnippet → videoUrl
**Промпт для Cursor:**
```
В таблице Questions поле codeSnippet используется для хранения Vimeo ID. Создай безопасную миграцию:

1. Добавь новое поле videoUrl в схему Prisma (Questions model)
2. Создай SQL миграцию для переноса данных:
   - ALTER TABLE "Questions" ADD COLUMN "videoUrl" TEXT;
   - UPDATE "Questions" SET "videoUrl" = "codeSnippet" WHERE "questionType" = 'VIDEO';
   - UPDATE "Questions" SET "codeSnippet" = NULL WHERE "questionType" = 'VIDEO';
3. Обнови все места использования codeSnippet для VIDEO типа на videoUrl
4. Протестируй что видео продолжают работать

НЕ УДАЛЯЙ поле codeSnippet - оно может использоваться для CODING_CHALLENGE.
```

**Проверка после выполнения:**
- [ ] Новое поле videoUrl создано и заполнено
- [ ] Видео уроки продолжают воспроизводиться
- [ ] Старое поле очищено для VIDEO типа

### Задача 6.1.3: Удаление неиспользуемых таблиц
**Промпт для Cursor:**
```
Создай SQL скрипт scripts/cleanup-unused-tables.sql для удаления пустых таблиц:

-- Проверь что таблицы действительно пустые перед удалением
DROP TABLE IF EXISTS "UserLeoChats" CASCADE; -- Переносим в новую структуру
DROP TABLE IF EXISTS "AIPrompts" CASCADE;
DROP TABLE IF EXISTS "LeagueUserActivity" CASCADE;
DROP TABLE IF EXISTS "LeagueUser" CASCADE;
DROP TABLE IF EXISTS "LeagueSeasonResults" CASCADE;
DROP TABLE IF EXISTS "UserBadges" CASCADE;
DROP TABLE IF EXISTS "Badge" CASCADE;
DROP TABLE IF EXISTS "SharedQuestionResults" CASCADE;
DROP TABLE IF EXISTS "UserMissionData" CASCADE;
DROP TABLE IF EXISTS "Missions" CASCADE;

ВАЖНО: 
- Проверь foreign key constraints
- НЕ УДАЛЯЙ таблицы с данными
- Сохрани структуру для возможного восстановления
```

**Проверка после выполнения:**
- [ ] Неиспользуемые таблицы удалены
- [ ] Основной функционал работает
- [ ] База данных не выдает ошибок

---

## ЭТАП 6.2: Рефакторинг навигации и маршрутов (2 дня)

### Задача 6.2.1: Обновление структуры сайдбара
**Промпт для Cursor:**
```
Обнови навигацию в src/utils/constants/sidebar.ts и связанные компоненты:

1. Основная навигация (порядок важен):
   - Главная (/dashboard)
   - Карта уровней (/roadmaps) - переименовать из "Library"
   - Профиль (/settings/profile) - вынести из settings
   - Чат с Leo (/leo-chat) - новая страница
   - Настройки (/settings)

2. Временно скрыть (добавить hidden: true):
   - Статистика (/statistics) // TODO: Включить в следующей версии
   - Достижения (/profile/achievements) // TODO: Включить после добавления контента
   - Персонализированные roadmaps (/personalized-roadmaps) // TODO: v2.0
   - Coding Challenges (/coding-challenges) // TODO: Переименовать в "Практика" в v2.0

3. Удалить полностью:
   - GitHub профиль (/profile/github)
   - Любые технические разделы

4. Обнови иконки для соответствия бизнес-тематике
```

**Проверка после выполнения:**
- [ ] Навигация содержит только нужные пункты
- [ ] Порядок пунктов логичный
- [ ] Скрытые разделы не отображаются

### Задача 6.2.2: Создание страницы чата с Leo
**Промпт для Cursor:**
```
Создай новую страницу для чата с Leo в src/app/(app)/leo-chat/page.tsx:

1. Структура страницы:
   - Левая панель: список предыдущих чатов
   - Основная область: текущий чат
   - Интерфейс как в современных чат-приложениях

2. Функционал:
   - Сохранение истории чатов
   - Возможность начать новый чат
   - Загрузка предыдущих диалогов
   - Контекст бизнес-обучения

3. Используй существующий useChat hook если есть
4. Стилизация в соответствии с остальным приложением

ВАЖНО: Leo должен отвечать только на бизнес-вопросы и знать о прогрессе пользователя.
```

**Проверка после выполнения:**
- [ ] Страница чата создана и доступна
- [ ] История чатов сохраняется
- [ ] Leo отвечает корректно

### Задача 6.2.3: Упрощение онбординга
**Промпт для Cursor:**
```
Упрости процесс онбординга для новых пользователей:

1. В src/hooks/use-onboarding-steps.ts или аналогичном:
   - Убрать шаг "Where would you like to begin?" (#first-question-selection)
   - Сразу направлять на первый уровень после регистрации

2. Настрой показ pricing блока:
   - Показывать только при первом входе
   - Сохранять флаг в localStorage: 'pricingShown': true
   - Проверять флаг при загрузке

3. Обнови flow:
   - Регистрация → Приветствие → Сразу первый уровень
   - Pricing показывается один раз в конце первого уровня

Комментарий в коде: 
// TODO: В v2.0 добавить персонализацию через вопросы
```

**Проверка после выполнения:**
- [ ] Онбординг упрощен до минимума
- [ ] Pricing показывается только один раз
- [ ] Пользователь сразу попадает на обучение

---

## ЭТАП 6.3: Русификация интерфейса (2 дня)

### Задача 6.3.1: Создание системы локализации
**Промпт для Cursor:**
```
Создай простую систему локализации для русского языка:

1. Создай файл src/utils/translations/ru.ts:
   export const translations = {
     common: {
       dashboard: 'Главная',
       levels: 'Карта уровней',
       profile: 'Профиль',
       settings: 'Настройки',
       chat: 'Чат с Leo',
       next: 'Далее',
       previous: 'Назад',
       complete: 'Завершить',
       // ... остальные общие термины
     },
     dashboard: {
       welcome: 'Добро пожаловать',
       continueLesson: 'Продолжить обучение',
       yourProgress: 'Ваш прогресс',
       // ... тексты для дашборда
     },
     // ... другие разделы
   }

2. Создай хук useTranslation() для использования
3. Начни с критических мест: навигация, кнопки, заголовки

НЕ ДЕЛАЙ полную локализацию сразу - только основное для MVP.
```

**Проверка после выполнения:**
- [ ] Система переводов создана
- [ ] Основные элементы UI на русском
- [ ] Легко добавлять новые переводы

### Задача 6.3.2: Перевод ключевых страниц
**Промпт для Cursor:**
```
Переведи тексты на ключевых страницах:

1. Dashboard (/dashboard):
   - "Your Roadmaps" → "Карта уровней"
   - Убрать блок questions полностью
   - "Continue Learning" → "Продолжить обучение"

2. Roadmaps (/roadmaps):
   - "Library" → "Карта уровней" (в заголовке)
   - "Your next recommended question" → "Продолжить с последнего урока"
   - Сделать ссылку на последний незавершенный урок пользователя

3. Страницы уроков:
   - "Next" → "Далее"
   - "Complete" → "Завершить"
   - "Lesson X of Y" → "Урок X из Y"

4. Общие элементы:
   - Все кнопки и навигация
   - Сообщения об ошибках
   - Подсказки и tooltips

Используй созданную систему переводов где возможно.
```

**Проверка после выполнения:**
- [ ] Dashboard полностью на русском
- [ ] Навигация переведена
- [ ] Основные действия понятны русскоязычному пользователю

---

## ЭТАП 6.4: Оптимизация UX и удаление лишнего (2 дня)

### Задача 6.4.1: Упрощение страниц уроков
**Промпт для Cursor:**
```
Упрости интерфейс страниц с уроками:

1. На страницах /question/[slug]:
   - Удали правый сайдбар (блок для заметок)
   - Сделай контент на всю ширину
   - Оставь только: видео/тест и кнопки навигации

2. Добавь блок "Материалы для скачивания":
   - Показывать ТОЛЬКО на последнем уроке каждого уровня
   - Заголовок: "Артефакты для самостоятельной работы"
   - Отображать Resources из БД (PDF ссылки, Google Drive)
   - Стилизовать как карточки с иконками

3. Упрости навигацию между уроками:
   - Убрать возможность перескакивать уроки
   - Строгая последовательность
   - Кнопка "Далее" активна только после просмотра/прохождения

Это MVP - пользователь следует жесткому сценарию обучения.
```

**Проверка после выполнения:**
- [ ] Правый сайдбар удален
- [ ] Материалы отображаются в конце уровня
- [ ] Навигация линейная

### Задача 6.4.2: Исправление ссылки "Продолжить обучение"
**Промпт для Cursor:**
```
Настрой корректную работу ссылки на последний урок:

1. В src/actions/user/get-last-lesson.ts создай функцию:
   - Получить последний отвеченный вопрос пользователя
   - Найти следующий вопрос в последовательности
   - Вернуть URL следующего урока

2. На странице /roadmaps:
   - Замени статичную ссылку на динамическую
   - "Продолжить с последнего урока" → /question/[nextSlug]
   - Если нет прогресса → первый урок первого уровня

3. В dashboard тоже обнови ссылки на продолжение

Логика: всегда ведем на следующий неотвеченный урок.
```

**Проверка после выполнения:**
- [ ] Ссылка ведет на правильный урок
- [ ] Работает для новых пользователей
- [ ] Работает при разном прогрессе

### Задача 6.4.3: Отключение ненужных features
**Промпт для Cursor:**
```
Отключи features которые не нужны в MVP:

1. В маршрутах добавь редиректы или 404:
   /coding-challenges → 404 с сообщением "Раздел появится в следующих обновлениях"
   /personalized-roadmaps → 404 с сообщением "Функция в разработке"
   /profile/achievements → редирект на /profile
   /statistics → доступно только админам (проверка роли)

2. Добавь комментарии в код:
   // TODO: /coding-challenges - переименовать в "Практика" и адаптировать под бизнес-задачи в v2.0
   // TODO: /personalized-roadmaps - AI-генерация путей обучения в v2.0
   // TODO: /statistics - открыть для всех после добавления бизнес-метрик

3. Создай компонент ComingSoon для таких страниц:
   - Красивая заглушка
   - Сообщение о будущей функции
   - Кнопка "Вернуться к обучению"

НЕ УДАЛЯЙ код - только отключи доступ.
```

**Проверка после выполнения:**
- [ ] Ненужные разделы недоступны
- [ ] Показываются понятные заглушки
- [ ] Код сохранен для будущего

---

## ЭТАП 6.5: Удаление технических компонентов (1 день)

### Задача 6.5.1: Удаление GitHub интеграции
**Промпт для Cursor:**
```
Полностью удали GitHub интеграцию:

1. Удали файлы:
   - components/marketing/global/navigation/github-stars.tsx
   - Любые GitHub OAuth endpoints
   - GitHub related API routes

2. Очисти упоминания:
   - В навигации замени GithubStars на null
   - Удали GitHub из социальных ссылок
   - Удали /profile/github маршрут

3. В Profile компонентах:
   - Удали поле github из форм
   - Удали GitHub секцию из отображения

4. Замени социальные ссылки на:
   - LinkedIn для бизнес-сети
   - Instagram для визуального контента
   - Telegram для сообщества

Это полное удаление - GitHub не нужен для бизнес-платформы.
```

**Проверка после выполнения:**
- [ ] Нет упоминаний GitHub в UI
- [ ] Социальные ссылки обновлены
- [ ] Нет ошибок компиляции

### Задача 6.5.2: Очистка маркетинговых текстов
**Промпт для Cursor:**
```
Исправь все оставшиеся программистские термины:

1. Найди и замени во всех маркетинговых компонентах:
   grep -r "coding\|programming\|developer\|code" src/components/marketing --include="*.tsx"
   
   "Empowering Developers Worldwide" → "Развиваем предпринимателей по всему миру"
   "coding skills" → "бизнес-навыки"
   "coding challenges" → "бизнес-задания"
   "code editor" → "редактор" (или удали упоминания)

2. В src/utils/constants/:
   - pricing.ts - обнови все описания
   - features.ts - замени технические features
   - testimonials.ts - замени на бизнес-отзывы

3. Проверь метаданные страниц:
   - title, description должны быть про бизнес
   - keywords обнови на бизнес-термины

Финальная проверка: ноль упоминаний программирования в UI.
```

**Проверка после выполнения:**
- [ ] Маркетинг полностью про бизнес
- [ ] SEO оптимизировано под бизнес
- [ ] Нет технических терминов

---

## ЭТАП 6.6: Оптимизация производительности (1 день)

### Задача 6.6.1: Удаление неиспользуемых зависимостей
**Промпт для Cursor:**
```
Очисти package.json от ненужных пакетов:

1. Анализ использования:
   # Создай список потенциально ненужных
   - monaco-editor, @monaco-editor/react
   - prettier-plugin-sql, prettier-plugin-prisma (если не используем)
   - @octokit/* (GitHub пакеты)
   - Любые code-highlighting библиотеки

2. Для каждого пакета:
   grep -r "packageName" src/ --include="*.tsx" --include="*.ts"
   
   Если не найдено использований:
   npm uninstall packageName

3. После удаления:
   npm install
   npm run build
   
   Если ошибки - верни пакет обратно

4. Финальная очистка:
   npm prune
   npm dedupe

Ожидаемое уменьшение: 20-30% от размера node_modules.
```

**Проверка после выполнения:**
- [ ] Удалены неиспользуемые пакеты
- [ ] Проект компилируется без ошибок
- [ ] package-lock.json обновлен

### Задача 6.6.2: Оптимизация bundle size
**Промпт для Cursor:**
```
Финальная оптимизация размера bundle:

1. Анализ текущего состояния:
   npm run analyze
   
   Сохрани скриншоты в docs/bundle-before-optimization/

2. Оптимизации:
   - Dynamic imports для всех тяжелых компонентов
   - Tree shaking для utility функций
   - Удали неиспользуемые импорты
   - Оптимизируй импорты библиотек (только нужные части)

3. В next.config.js:
   - Проверь что включен SWC minifier
   - Оптимизация изображений включена
   - Compression включена

4. После оптимизации:
   npm run analyze
   
   Сохрани в docs/bundle-after-optimization/

Цель: Initial JS < 300KB (сейчас ~617KB).
```

**Проверка после выполнения:**
- [ ] Bundle size уменьшился на 40%+
- [ ] Нет regression в функционале
- [ ] Документированы изменения

---

## ЭТАП 6.7: Финальное тестирование и документация (1 день)

### Задача 6.7.1: Полное тестирование MVP
**Промпт для Cursor:**
```
Создай и выполни чеклист тестирования docs/mvp-testing-checklist.md:

# Чеклист тестирования BizLevel MVP

## Новый пользователь
- [ ] Регистрация работает
- [ ] Сразу попадает на первый урок
- [ ] Нет технических вопросов при онбординге
- [ ] Интерфейс полностью на русском

## Прохождение уроков
- [ ] Видео воспроизводятся (Vimeo)
- [ ] Тесты работают корректно
- [ ] Прогресс сохраняется
- [ ] Навигация "Далее" работает линейно
- [ ] Материалы отображаются в конце уровня

## Навигация
- [ ] Сайдбар содержит только нужные пункты
- [ ] "Продолжить обучение" ведет на правильный урок
- [ ] Чат с Leo доступен и работает
- [ ] Профиль доступен из сайдбара

## Отключенные features
- [ ] /coding-challenges показывает заглушку
- [ ] /statistics недоступна обычным пользователям
- [ ] /personalized-roadmaps показывает "В разработке"
- [ ] GitHub интеграция полностью удалена

## Производительность
- [ ] Страницы грузятся < 2 сек
- [ ] Нет ошибок в консоли
- [ ] Мобильная версия работает

Пройди каждый пункт и отметь статус.
```

**Проверка после выполнения:**
- [ ] Все пункты чеклиста пройдены
- [ ] Критические баги исправлены
- [ ] MVP готов к запуску

### Задача 6.7.2: Создание финальной документации
**Промпт для Cursor:**
```
Создай финальную документацию проекта:

1. docs/BIZLEVEL_MVP_COMPLETE.md:
   # BizLevel MVP - Отчет о завершении
   
   ## Что сделано
   - Полная трансформация из TechBlitz
   - Русификация интерфейса
   - Упрощение UX для линейного обучения
   - Интеграция Vimeo для видео
   - Чат с AI помощником Leo
   
   ## Удалено/Отключено
   - GitHub интеграция (удалена)
   - Coding challenges (отключены до v2.0)
   - Personalized roadmaps (отключены до v2.0)
   - Statistics для пользователей (только админы)
   - Achievements (отключены до контента)
   
   ## Метрики
   - Bundle size: XXX KB (было 617KB)
   - Lighthouse score: XX/100
   - Количество удаленных файлов: XXX
   - Количество удаленных зависимостей: XX
   
   ## Что дальше (v2.0)
   - Добавить больше уровней (сейчас 5)
   - Включить практические задания
   - Персонализация обучения
   - Система достижений
   - Расширенная статистика

2. README.md - обнови для BizLevel

3. .env.example - проверь что все актуально

Это финальная документация для передачи проекта.
```

**Проверка после выполнения:**
- [ ] Документация полная и понятная
- [ ] README обновлен
- [ ] Проект готов к передаче

---

## Ожидаемые результаты:

После выполнения Этапа 6:
- **Интерфейс:** 100% на русском языке
- **Навигация:** Упрощена до 5 основных пунктов
- **UX:** Линейное прохождение без выбора
- **Производительность:** Bundle < 300KB, Lighthouse 90+
- **Чистота кода:** 0 упоминаний программирования
- **Готовность:** MVP полностью готов к запуску

## Временные оценки:

- **Этап 6.1:** Очистка БД - 2 дня
- **Этап 6.2:** Рефакторинг навигации - 2 дня
- **Этап 6.3:** Русификация - 2 дня
- **Этап 6.4:** Оптимизация UX - 2 дня
- **Этап 6.5:** Удаление техники - 1 день
- **Этап 6.6:** Оптимизация - 1 день
- **Этап 6.7:** Тестирование - 1 день

**Итого:** 11 рабочих дней

## Критические напоминания:

1. **Сначала бэкап** - перед любыми удалениями
2. **Тестируй каждый шаг** - не накапливай изменения
3. **Коммить часто** - с понятными сообщениями
4. **Документируй TODO** - для будущих версий
5. **Проверяй русификацию** - никакого English в UI
6. **MVP это не навсегда** - сохраняй код для v2.0